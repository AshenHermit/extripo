function makeDictMaker(t,r){return function(e=null){var s={};return s[t]=null!=r?r:e,s}}var ftKeys={arrayOf:null,dictOf:null,instanceOf:null,ignore:!0},fcCtx={};Object.keys(ftKeys).forEach((t=>{fcCtx[t]=makeDictMaker(t,ftKeys[t])}));class ExportableConfig{constructor(t="__export_config"){this.classes={ofFields:{},inArray:{},inDict:{}},this.defaultFieldsToIgnore=[t],this.fieldsToIgnore=Array.from(this.defaultFieldsToIgnore)}specifyClasses(t){return t?(Object.keys(t).forEach((r=>{r in this.classes&&Object.assign(this.classes[r],t[r])})),this):this}configFields(t){return Object.keys(t).forEach((r=>{var e=t[r];e.dictOf&&this.specifyClasses({inDict:{[r]:e.dictOf}}),e.arrayOf&&this.specifyClasses({inArray:{[r]:e.arrayOf}}),e.instanceOf&&this.specifyClasses({ofFields:{[r]:e.instanceOf}}),e.ignore&&this.ignoreFields([r])})),this}ignoreFields(t){return t&&(this.fieldsToIgnore=this.fieldsToIgnore.concat(t)),this}infectWithSetters(t){[this.specifyClasses,this.ignoreFields,this.configFields].forEach((r=>{t[r.name]=r.bind(this)}).bind(this))}}function convertToDict(t){return JSON.parse(JSON.stringify(t))}function processContainerValue(t,r,e,s){var i=null;if(null!=e)i=t(r,e,s);void 0!==i&&(r[s]=i)}function processDict(t,r){if(null==t)return null;var e=Object.assign({},t);return Object.keys(e).forEach((t=>{processContainerValue(r,e,e[t],t)})),e}function processArray(t,r){if(null==t)return null;var e=Array.from(t);return e.forEach(((t,s)=>{processContainerValue(r,e,t,s)})),e}class Exportable{constructor(){this.__export_config=new ExportableConfig("__export_config"),this.__export_config.infectWithSetters(this)}specifyClasses(t){}ignoreFields(t){}configFields(t){}static exportArray(t){return processArray(t,((t,r,e)=>(r.exportData&&(t[e]=r.exportData()),t[e])))}static importArray(t,r){return r?processArray(t,((t,e,s)=>(new r).importData(e))):t}static exportDict(t){return processDict(t,((t,r,e)=>(r.exportData&&(t[e]=r.exportData()),t[e])))}static importDict(t,r){return r?processDict(t,((t,e,s)=>(new r).importData(e))):t}static create(t={},...r){var e=new this.prototype.constructor(...r);return e.importData(t),e}static createFromJSON(t,r,...e){var s=new this.prototype.constructor(...e);return s.importJSON(t),s}copy(...t){var r=this.exportData(),e=new this.__proto__.constructor(...t);return e.importData(r),e}importData(t){if(!t)return this;t=Object.assign({},t);var r=this.__export_config;return null!=r.fieldsToIgnore&&r.fieldsToIgnore.forEach((r=>{null!=r&&delete t[r]})),Object.assign(this,t),null!=r.classes.inArray&&Object.keys(r.classes.inArray).forEach((e=>{e in t&&(this[e]=Exportable.importArray(t[e],r.classes.inArray[e]))})),null!=r.classes.inDict&&Object.keys(r.classes.inDict).forEach((e=>{e in t&&(this[e]=Exportable.importDict(t[e],r.classes.inDict[e]))})),null!=r.classes.ofFields&&Object.keys(r.classes.ofFields).forEach((e=>{null!==t[e]&&void 0!==t[e]?e in t&&(this[e]=(new r.classes.ofFields[e]).importData(t[e])):this[e]=t[e]})),this}exportData(){var t=convertToDict(this),r=this.__export_config;return Object.keys(t).forEach((e=>{-1==r.fieldsToIgnore.indexOf(e)&&null!==t[e]&&void 0!==t[e]&&(this[e].exportData?t[e]=this[e].exportData():Array.isArray(this[e])?t[e]=Exportable.exportArray(this[e]):"object"==typeof this[e]&&(t[e]=Exportable.exportDict(this[e])))})),null!=r.fieldsToIgnore&&r.fieldsToIgnore.forEach((r=>{null!=r&&delete t[r]})),t}exportJSON(t=null,r=null){var e=this.exportData();return JSON.stringify(e,t,r)}importJSON(t){var r=JSON.parse(t);return this.importData(r)}}module.exports.Exportable=Exportable,module.exports.ExportableConfig=ExportableConfig,module.exports.FC=fcCtx;
